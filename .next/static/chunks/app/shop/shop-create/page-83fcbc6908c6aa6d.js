(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[783],{9847:(e,r,a)=>{Promise.resolve().then(a.bind(a,1215))},1215:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>U});var n=a(5155),t=a(3312),l=a(8986),s=a(2133),i=a(5564),o=a(378),d=a(6572),c=a(890),m=a(4039);let h=()=>{let[e,{loading:r,error:a}]=(0,m.n)(o.UW);return{createShop:async r=>{try{var a;let n=await e({variables:{name:r.name,logo:r.logo,description:r.description,address:r.address,phone:r.phone,category_id:r.category_id,created_at:r.created_at,remark:r.remark,shop_admin_name:r.shop_admin_name}});return null==n?void 0:null===(a=n.data)||void 0===a?void 0:a.insert_shops_one}catch(e){throw console.error("error creating user:",e),e}},loadingCreteShop:r,errorCreateShop:a}};var p=a(698);function u(){let e=(0,p._)(["\n  mutation userRegister($email: String!, $password: String!, $username: String!, $role: String!, $phone: String, $shop_id: uuid) {\n    userRegister(email: $email, password: $password, username: $username, role: $role, phone: $phone, shop_id: $shop_id) {\n      message\n      user_id\n    }\n  }\n"]);return u=function(){return e},e}let x=(0,a(8247).J1)(u()),g=()=>{let[e,{loading:r,error:a}]=(0,m.n)(x);return{createUser:async r=>{try{let a=await e({variables:r});return null==a?void 0:a.data}catch(e){throw console.error("Error creating user:",e),e}},loadingCreateUser:r,createUserError:a}};var f=a(5875),_=a(7835),b=a(4136),j=a(3604),w=a(1621),v=a(1496),y=a(767),N=a(7594),$=a(5565),S=a(2115),k=a(9606);let A=()=>{let[e,r]=(0,S.useState)(0),[a,p]=(0,S.useState)([]),[u,x]=(0,S.useState)([]),[A,U]=(0,S.useState)(),[E,R]=(0,S.useState)(""),{shopCategories:D}=(0,c.CE)(),{createShop:C}=h(),[L,I]=(0,S.useState)(!1),{uploadToS3:H}=(0,d.w)(),{createUser:J}=g(),{handleSubmit:O,register:P,reset:z}=(0,k.mN)(),{toast:F}=(0,i.dj)(),[T]=(0,m.n)(o.XD);console.log(E);let q=e=>{p(r=>r.filter((r,a)=>a!==e))},B=e=>{x(r=>r.filter((r,a)=>a!==e))},W=async e=>{let r=[];for(let n of a){let a=await H(n);a&&(r.push(a),await T({variables:{shop_id:e,image_url:a}}))}console.log("Uploaded image URLs:",r)},G=async e=>{await J({username:e.username,email:e.email,password:e.password,role:e.role,phone:e.phone,shop_id:e.shop_id})},X=O(async e=>{if(!a.length)return F({title:"Invalid Data",description:"Please choose at least one photo."});if(!u.length)return F({title:"Invalid Data",description:"Please upload banner image."});if(!E)return F({title:"Invalid Data",description:"Please choose category."});if(!A)return F({title:"Invalid Data",description:"Please choose a date."});try{I(!0);let r=await H(u[0]);if(r&&console.log("shopphone:",e.shop_phone),r){let a=await C({name:e.shop_name,logo:r,description:e.description,address:e.address,phone:e.shop_phone,created_at:new Date(A||Date.now()).toISOString(),category_id:E,remark:e.remark,shop_admin_name:e.shop_admin_name});if(a){let r=a.id;await Promise.all([G({username:e.username,password:e.password,email:e.email,phone:e.phone,role:"shop admin",shop_id:r}),W(r)])}F({description:"Shop created"})}}catch(e){console.log("Error creating product:",e),F({variant:"destructive",title:"Uh oh! Something went wrong.",description:"There was a problem while creating shop.",action:(0,n.jsx)(s.Qg,{altText:"Try again",children:"Try again"})})}finally{I(!1)}});return(0,n.jsxs)("section",{className:"w-full flex flex-col gap-4",children:[(0,n.jsxs)("div",{className:"w-full min-h-20 flex flex-row items-center gap-2",children:[(0,n.jsx)("div",{className:"h-11 w-11",children:(0,n.jsx)(f.A,{})}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"Back to shop list"}),(0,n.jsx)("h1",{className:"text-headercolor font-bold text-xl",children:"Add New Shop"})]})]}),(0,n.jsx)("form",{onSubmit:X,children:(0,n.jsxs)("div",{className:"w-full grid lg:grid-cols-2 lg:gap-x-12 md:grid-cols-1 md:gap-y-8 min-h-32",children:[(0,n.jsxs)("div",{className:"w-[30rem] h-full flex flex-col gap-8",children:[(0,n.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,n.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Description"}),(0,n.jsxs)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex flex-col gap-6 p-8",children:[(0,n.jsx)("div",{className:"w-1/2",children:(0,n.jsx)(b.A,{name:"shop_name",label:"Shop Name",placeHolder:"Enter shop name",type:"text",register:P})}),(0,n.jsx)(j.A,{placeHolder:"Enter shop Description Here",label:"Shop Description",name:"description",register:P})]})]}),(0,n.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,n.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Category"}),(0,n.jsx)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex flex-col gap-6 p-8",children:(0,n.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,n.jsx)(l.J,{className:"text-inputlabel",children:"Shop Category"}),(0,n.jsx)(w.A,{label:"Select Category",setCategory:R,options:D})]})})]}),(0,n.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,n.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Shop Address & Contact"}),(0,n.jsxs)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex flex-col gap-6 p-8",children:[(0,n.jsx)(b.A,{name:"address",label:"Shop Address *",placeHolder:"Enter shop address",type:"text",register:P}),(0,n.jsx)(b.A,{name:"shop_phone",label:"Shop Phone Number *",placeHolder:"Enter shop phone number",type:"text",register:P})]})]}),(0,n.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,n.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Shop Admin Detail"}),(0,n.jsxs)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex flex-col gap-6 p-8",children:[(0,n.jsx)(b.A,{name:"shop_admin_name",label:"Full Name",placeHolder:"Enter full name",type:"text",register:P}),(0,n.jsx)(b.A,{name:"email",label:"Email *",placeHolder:"Enter email",type:"text",register:P}),(0,n.jsx)(b.A,{name:"phone",label:"Phone Number *",placeHolder:"Enter phone number",type:"text",register:P})]})]}),(0,n.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,n.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Authentication Detail"}),(0,n.jsxs)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex flex-col gap-6 p-8",children:[(0,n.jsx)(b.A,{name:"username",label:"Username *",placeHolder:"Enter username",type:"text",register:P}),(0,n.jsx)(b.A,{name:"password",label:"Password*",placeHolder:"Enter password",type:"password",register:P})]})]})]}),(0,n.jsxs)("div",{className:"w-[30rem] h-full flex flex-col gap-8",children:[(0,n.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,n.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Shop Images"}),(0,n.jsxs)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex flex-wrap items-center justify-center gap-6 p-8",children:[(0,n.jsx)(v.A,{className:"w-[10rem]",onFileSelect:e=>{p(r=>[...r,...Array.from(e)])},multiple:!0}),a.map((e,r)=>(0,n.jsxs)("div",{className:"w-[10rem] h-[10rem] relative",children:[(0,n.jsx)($.default,{src:URL.createObjectURL(e),width:100,height:100,className:"w-full h-full object-cover rounded-md border",alt:"Uploaded image ".concat(r+1)}),(0,n.jsx)("div",{onClick:()=>q(r),className:"absolute top-1 right-2 hover:cursor-pointer",children:(0,n.jsx)(y.A,{size:30,color:"black"})})]},r))]})]}),(0,n.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,n.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Shop Banner Image"}),(0,n.jsxs)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex flex-wrap items-center justify-center gap-6 p-8",children:[u.length<1?(0,n.jsx)(v.A,{className:"w-[10rem]",onFileSelect:e=>{x(r=>[...r,...Array.from(e)])},multiple:!0}):null,u.map((e,r)=>(0,n.jsxs)("div",{className:"w-[10rem] h-[10rem] relative",children:[(0,n.jsx)($.default,{src:URL.createObjectURL(e),width:100,height:100,className:"w-full h-full object-cover rounded-md border",alt:"Uploaded image ".concat(r+1)}),(0,n.jsx)("div",{onClick:()=>B(r),className:"absolute top-1 right-2 hover:cursor-pointer",children:(0,n.jsx)(y.A,{size:30,color:"black"})})]},r))]})]}),(0,n.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,n.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Remark"}),(0,n.jsx)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex flex-col gap-6 p-8",children:(0,n.jsx)(j.A,{placeHolder:"Enter remark here",label:"Remark",name:"remark",register:P})})]}),(0,n.jsxs)("div",{className:"w-full min-h-20 flex flex-row justify-between",children:[(0,n.jsx)("div",{children:(0,n.jsx)(t.$,{type:"button",onClick:()=>{z(),p([]),x([]),a.forEach(e=>URL.revokeObjectURL(URL.createObjectURL(e))),u.forEach(e=>URL.revokeObjectURL(URL.createObjectURL(e))),r(e=>e+1)},className:"bg-transparent border border-gray-300 rounded-md text-red-500 min-w-[5rem]",children:"Discard"})}),(0,n.jsxs)("div",{className:"flex flex-row gap-3",children:[(0,n.jsx)(_.G,{loading:L,setSelectedDate:U}),(0,n.jsx)(t.$,{type:"submit",disabled:L,className:"rounded-md flex items-center justify-center text-white bg-inputlabel min-w-[7rem]",children:L?(0,n.jsx)(N.A,{className:"animate-spin",size:25}):"Add Shop"})]})]})]})]})},e)]})},U=()=>(0,n.jsx)("div",{className:"",children:(0,n.jsx)(A,{})})},378:(e,r,a)=>{"use strict";a.d(r,{B$:()=>x,Ld:()=>p,UW:()=>m,XD:()=>h,zV:()=>u});var n=a(698),t=a(8247);function l(){let e=(0,n._)(["\n  mutation createShop(\n   $name: String\n   $logo: String\n   $description: String\n   $address: String\n   $phone: String\n   $category_id: uuid\n   $created_at: timestamptz\n   $remark: String\n   $shop_admin_name: String\n  ) {\n    insert_shops_one(\n      object: {\n        name: $name\n        logo: $logo\n        description: $description\n        address: $address\n        phone: $phone\n        category_id: $category_id\n        created_at: $created_at\n        remark: remark\n        shop_admin_name: $shop_admin_name\n      }\n    ) {\n      id\n      name\n      logo\n      description\n      address\n      phone\n      category_id\n      created_at\n      remark\n      shop_admin_name\n    }\n  }\n"]);return l=function(){return e},e}function s(){let e=(0,n._)(["\n  mutation createUser(\n    $username: String!\n    $email: String!\n    $password: String!\n    $role: String!\n    $shop_id: uuid!\n  ) {\n    insert_users_one(\n      object: {\n        username: $username\n        email: $email\n        password: $password\n        role: $role\n        shop_id: $shop_id\n      }\n    ) {\n      id\n      username\n      email\n      role\n      shop_id\n    }\n  }\n"]);return s=function(){return e},e}function i(){let e=(0,n._)(["\n  mutation createShopImages(\n   $image_url: String\n   $shop_id: uuid\n  ) {\n    insert_shop_images_one(\n      object: {\n        image_url: $image_url\n        shop_id: $shop_id\n      }\n    ) {\n      id\n      image_url\n      shop_id\n    }\n  }\n"]);return i=function(){return e},e}function o(){let e=(0,n._)(["\n  mutation updateShopById(\n    $id: uuid!\n    $name: String\n    $logo: String\n    $description: String\n    $address: String\n    $phone: String\n    $category_id: uuid\n    $remark: String\n    $shop_admin_name: String\n  ) {\n    update_shops_by_pk(\n      pk_columns: { id: $id }\n      _set: {\n        name: $name\n        logo: $logo\n        description: $description\n        address: $address\n        phone: $phone\n        category_id: $category_id\n        remark: $remark\n        shop_admin_name: $shop_admin_name\n      }\n    ) {\n      id\n      name\n      logo\n      description\n      address\n      phone\n      category_id\n      remark\n      shop_admin_name\n    }\n  }\n"]);return o=function(){return e},e}function d(){let e=(0,n._)(["\n  mutation deleteImage($id: uuid!) {\n    delete_shop_images_by_pk(id: $id) {\n      id\n      shop_id\n      image_url\n    }\n  }\n"]);return d=function(){return e},e}function c(){let e=(0,n._)(["\n  mutation deleteShop($id: uuid!) {\n    delete_shops_by_pk(id: $id) {\n      id\n      name\n    }\n  }\n"]);return c=function(){return e},e}let m=(0,t.J1)(l());(0,t.J1)(s());let h=(0,t.J1)(i()),p=(0,t.J1)(o()),u=(0,t.J1)(d()),x=(0,t.J1)(c())},7835:(e,r,a)=>{"use strict";a.d(r,{G:()=>h});var n=a(5155),t=a(2115),l=a(3312),s=a(3518),i=a(6967),o=a(7192),d=a(1567);function c(e){let{className:r,classNames:a,showOutsideDays:t=!0,...c}=e;return(0,n.jsx)(o.hv,{showOutsideDays:t,className:(0,d.cn)("p-3",r),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,d.cn)((0,l.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,d.cn)((0,l.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:e=>{let{className:r,...a}=e;return(0,n.jsx)(s.A,{className:(0,d.cn)("h-4 w-4",r),...a})},IconRight:e=>{let{className:r,...a}=e;return(0,n.jsx)(i.A,{className:(0,d.cn)("h-4 w-4",r),...a})}},...c})}c.displayName="Calendar";var m=a(9095);function h(e){let{setSelectedDate:r,loading:a=!1}=e,[s,i]=t.useState();return(0,n.jsxs)(m.AM,{children:[(0,n.jsx)(m.Wv,{asChild:!0,children:(0,n.jsx)(l.$,{disabled:a,className:"bg-slate-200 text-inputlabel rounded-md min-w-[7rem] hover:text-white",children:"Shcedule"})}),(0,n.jsx)(m.hl,{className:"w-auto p-0",children:(0,n.jsx)(c,{mode:"single",selected:s,onSelect:e=>{i(e),r(e)},initialFocus:!0})})]})}},4136:(e,r,a)=>{"use strict";a.d(r,{A:()=>s});var n=a(5155),t=a(3900),l=a(8986);let s=e=>{let{label:r,name:a,type:s,placeHolder:i,register:o,...d}=e;return(0,n.jsxs)("div",{className:"w-full h-full flex flex-col gap-2",children:[(0,n.jsx)(l.J,{htmlFor:String(a),className:"text-inputlabel",children:r}),(0,n.jsx)(t.p,{id:String(a),type:s,placeholder:i,...o?o(a,{required:"".concat(String(a)," is required")}):{},..."file"!==s?d:{}})]})}},3604:(e,r,a)=>{"use strict";a.d(r,{A:()=>o});var n=a(5155),t=a(8986),l=a(6754),s=a(2473),i=a(2115);let o=e=>{let{label:r,name:a,placeHolder:o,register:d,...c}=e,[m,h]=(0,i.useState)("");return(0,n.jsxs)("div",{className:"w-full h-full flex flex-col gap-2",children:[(0,n.jsxs)("div",{className:"w-full flex flex-row justify-between",children:[(0,n.jsx)(t.J,{htmlFor:a,className:"text-inputlabel",children:r}),(0,n.jsxs)("label",{className:"no-underline text-inputlabel text-sm cursor-pointer",children:[(0,n.jsxs)("div",{className:"text-inputlabel text-sm flex items-center gap-1",children:[(0,n.jsx)(s.A,{size:20,color:"#796f6f"})," Upload text file"]}),(0,n.jsx)("input",{type:"file",accept:".txt",className:"hidden",onChange:e=>{var r;let a=null===(r=e.target.files)||void 0===r?void 0:r[0];if(a){let e=new FileReader;e.onload=()=>{h(e.result)},e.readAsText(a)}}})]})]}),(0,n.jsx)(l.T,{...d?d(a,{required:"".concat(String(a)," is required")}):{},id:a,className:"min-h-36",name:a,placeholder:o,value:m,onChange:e=>h(e.target.value),...c})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[586,913,147,244,785,499,273,352,874,558,309,441,517,358],()=>r(9847)),_N_E=e.O()}]);