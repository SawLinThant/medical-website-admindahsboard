(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[201],{5508:(e,t,a)=>{Promise.resolve().then(a.bind(a,3597))},4807:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(7401).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},3597:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>q});var r=a(5155),n=a(7079),l=a(8467),s=a(3312),i=a(8986),d=a(2133),c=a(5564),o=a(9959),u=a(6572),p=a(890),x=a(3900),m=a(4807);let g=e=>{let{label:t,name:a,placeHolder:n,register:l,...s}=e;return(0,r.jsxs)("div",{className:"w-full h-full flex flex-col gap-2",children:[(0,r.jsx)(i.J,{className:"text-inputlabel",children:t}),(0,r.jsxs)("div",{className:"w-full relative",children:[(0,r.jsx)(x.p,{type:"number",placeholder:n,...l?l(a,{required:"".concat(String(a)," is required")}):{},...s,className:"py-2 pl-12 pr-2 rounded-lg border border-gray-300"}),(0,r.jsx)("div",{className:"absolute top-2 left-3.5 ",children:(0,r.jsx)("div",{className:"w-[25px] h-[25px] rounded-lg text-center bg-[#c5bfc7] flex items-center justify-center",children:(0,r.jsx)(m.A,{size:15,color:"#211d22"})})})]})]})};var h=a(6680),f=a(7835),_=a(4136),j=a(3604),b=a(1621),v=a(1496),y=a(6295),w=a(4039),N=a(767),$=a(7594),S=a(5565),A=a(2115),k=a(9606);let P=e=>{let{shop_id:t}=e,[a,n]=(0,A.useState)(0),[l,x]=(0,A.useState)([]),[m,P]=(0,A.useState)([]),[I,q]=(0,A.useState)(),[C,D]=(0,A.useState)(""),[T,U]=(0,A.useState)(!1),{uploadToS3:E}=(0,u.w)(),{tags:J}=(0,p.jt)(),{categories:L}=(0,p.E5)(),{handleSubmit:R,register:H,reset:z}=(0,k.mN)(),{toast:O}=(0,c.dj)(),[F]=(0,w.n)(o.xq),[B]=(0,w.n)(o.gI),[G]=(0,w.n)(o.b);console.log("shop_id:",t);let M=e=>{x(t=>t.filter((t,a)=>a!==e))},W=async e=>{let t=[];for(let a of l){let r=await E(a);r&&(t.push(r),await G({variables:{product_id:e,image_url:r}}))}console.log("Uploaded image URLs:",t)},Q=async e=>{for(let t of m)await B({variables:{product_id:e,tag_id:t.id}})},Y=R(async e=>{if(!l.length)return O({title:"Invalid Data",description:"Please choose at least one photo."});if(!C)return O({title:"Invalid Data",description:"Please choose category."});if(!I)return O({title:"Invalid Data",description:"Please choose a date."});if(m.length<1)return O({title:"Invalid Data",description:"Please choose at least one tag."});try{var a,n;U(!0);let r=await F({variables:{name:e.name,price:e.price,bulk_price:e.bulk_price,quantity:1,description:e.description,dosage:e.dosage,usage:e.usage,storage:e.storage,created_at:new Date(I||Date.now()).toISOString(),shop_id:t,category_id:C}}),l=null===(n=r.data)||void 0===n?void 0:null===(a=n.insert_products_one)||void 0===a?void 0:a.id;l&&await Promise.all([W(l),Q(l)]),O({description:"Product created"})}catch(e){console.log("Error creating product:",e),O({variant:"destructive",title:"Uh oh! Something went wrong.",description:"There was a problem while creating product.",action:(0,r.jsx)(d.Qg,{altText:"Try again",children:"Try again"})})}finally{U(!1)}});return console.log(m),(0,r.jsxs)("section",{className:"w-full flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"w-full min-h-20 flex flex-row items-center gap-2",children:[(0,r.jsx)("div",{className:"h-11 w-11",children:(0,r.jsx)(h.o,{})}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Back to product list"}),(0,r.jsx)("h1",{className:"text-headercolor font-bold text-xl",children:"Add New Product"})]})]}),(0,r.jsx)("form",{onSubmit:Y,children:(0,r.jsxs)("div",{className:"w-full grid lg:grid-cols-2 lg:gap-x-12 md:grid-cols-1 md:gap-y-8 min-h-32",children:[(0,r.jsxs)("div",{className:"w-[30rem] h-full flex flex-col gap-8",children:[(0,r.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,r.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Description"}),(0,r.jsxs)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex flex-col gap-6 p-8",children:[(0,r.jsx)("div",{className:"w-1/2",children:(0,r.jsx)(_.A,{name:"name",label:"Product Name",placeHolder:"Enter product name",type:"text",register:H})}),(0,r.jsx)(j.A,{placeHolder:"Enter Porduct Description Here",label:"Product Description",name:"description",register:H}),(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(_.A,{name:"dosage",label:"Dosage",placeHolder:"Enter Dosage",type:"text",register:H})}),(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(_.A,{name:"usage",label:"Usage",placeHolder:"Enter Usage",type:"text",register:H})}),(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(_.A,{name:"storage",label:"Storage",placeHolder:"Enter Storage",type:"text",register:H})})]})]}),(0,r.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,r.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Category & Tag"}),(0,r.jsxs)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex flex-col gap-6 p-8",children:[(0,r.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,r.jsx)(i.J,{className:"text-inputlabel",children:"Product Category"}),(0,r.jsx)(b.A,{label:"Select Category",setCategory:D,options:L})]}),(0,r.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,r.jsx)(i.J,{className:"text-inputlabel",children:"Tags"}),(0,r.jsx)(y.A,{removeTag:e=>{P(t=>t.filter((t,a)=>a!==e))},setTag:P,options:J,selectedTag:m})]})]})]})]}),(0,r.jsxs)("div",{className:"w-[30rem] h-full flex flex-col gap-8",children:[(0,r.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,r.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Product Images"}),(0,r.jsxs)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex flex-wrap items-center justify-center gap-6 p-8",children:[(0,r.jsx)(v.A,{className:"w-[10rem]",onFileSelect:e=>{x(t=>[...t,...Array.from(e)])},multiple:!0}),l.map((e,t)=>(0,r.jsxs)("div",{className:"w-[10rem] h-[10rem] relative",children:[(0,r.jsx)(S.default,{src:URL.createObjectURL(e),width:100,height:100,className:"w-full h-full object-cover rounded-md border",alt:"Uploaded image ".concat(t+1)}),(0,r.jsx)("div",{onClick:()=>M(t),className:"absolute top-1 right-2 hover:cursor-pointer",children:(0,r.jsx)(N.A,{size:30,color:"black"})})]},t))]})]}),(0,r.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,r.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Pricing"}),(0,r.jsx)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex items-center justify-center gap-6 p-8",children:(0,r.jsxs)("div",{className:"w-full grid grid-cols-2 gap-4",children:[(0,r.jsx)(g,{register:H,label:"Price",name:"price",placeHolder:"000.00"}),(0,r.jsx)(g,{register:H,label:"Bulk Price",name:"bulk_price",placeHolder:"000.00"})]})})]}),(0,r.jsxs)("div",{className:"w-full min-h-20 flex flex-row justify-between",children:[(0,r.jsx)("div",{children:(0,r.jsx)(s.$,{type:"button",onClick:()=>{z(),x([]),l.forEach(e=>URL.revokeObjectURL(URL.createObjectURL(e))),n(e=>e+1)},className:"bg-transparent border border-gray-300 rounded-md text-red-500 min-w-[5rem]",children:"Discard"})}),(0,r.jsxs)("div",{className:"flex flex-row gap-3",children:[(0,r.jsx)(f.G,{loading:T,setSelectedDate:q}),(0,r.jsx)(s.$,{type:"submit",disabled:T,className:"rounded-md flex items-center justify-center text-white bg-inputlabel min-w-[7rem]",children:T?(0,r.jsx)($.A,{className:"animate-spin",size:25}):"Add Product"})]})]})]})]})},a)]})};var I=a(8870);let q=()=>{var e;let{userId:t}=(0,l.F)(),{data:a}=(0,I.IT)(n.T,{variables:{id:t}}),s=a?null===(e=a.users)||void 0===e?void 0:e[0]:[];return(0,r.jsx)("div",{className:"",children:(0,r.jsx)(P,{shop_id:s.shop_id})})}},9959:(e,t,a)=>{"use strict";a.d(t,{b:()=>g,gI:()=>x,kZ:()=>h,lm:()=>m,oY:()=>_,q:()=>f,xq:()=>p});var r=a(698),n=a(8247);function l(){let e=(0,r._)(["\n  mutation createProduct(\n    $name: String\n    $price: Int\n    $bulk_price: Int\n    $quantity: Int\n    $description: String\n    $dosage: String\n    $usage: String\n    $storage: String\n    $shop_id: uuid\n    $category_id: uuid\n    $created_at: timestamptz\n  ) {\n    insert_products_one(\n      object: {\n        name: $name\n        price: $price\n        bulk_price: $bulk_price\n        quantity: $quantity\n        description: $description\n        dosage: $dosage\n        usage: $usage\n        storage: $storage\n        shop_id: $shop_id\n        category_id: $category_id\n        created_at: $created_at\n      }\n    ) {\n      id\n      name\n      category_id\n      price\n      bulk_price\n      quantity\n      description\n      created_at\n    }\n  }\n"]);return l=function(){return e},e}function s(){let e=(0,r._)(["\n  mutation createProductTag($product_id: uuid, $tag_id: uuid) {\n    insert_product_tags_one(\n      object: { product_id: $product_id, tag_id: $tag_id }\n    ) {\n      id\n      product_id\n      tag_id\n    }\n  }\n"]);return s=function(){return e},e}function i(){let e=(0,r._)(["\n  mutation DeleteProductTag($product_id: uuid!, $tag_id: uuid!) {\n    delete_product_tags(\n      where: { product_id: { _eq: $product_id }, tag_id: { _eq: $tag_id } }\n    ) {\n      affected_rows\n    }\n  }\n"]);return i=function(){return e},e}function d(){let e=(0,r._)(["\n  mutation createImage($product_id: uuid, $image_url: String) {\n    insert_images_one(\n      object: { product_id: $product_id, image_url: $image_url }\n    ) {\n      id\n      product_id\n      image_url\n    }\n  }\n"]);return d=function(){return e},e}function c(){let e=(0,r._)(["\n  mutation deleteImage($id: uuid!) {\n    delete_images_by_pk(id: $id) {\n      id\n      product_id\n      image_url\n    }\n  }\n"]);return c=function(){return e},e}function o(){let e=(0,r._)(["\n  mutation updateProduct(\n    $id: uuid!\n    $name: String\n    $price: Int\n    $bulk_price: Int\n    $quantity: Int\n    $description: String\n    $dosage: String\n    $usage: String\n    $storage: String\n    $category_id: uuid\n    $updated_at: timestamptz\n  ) {\n    update_products_by_pk(\n      pk_columns: { id: $id }\n      _set: {\n        name: $name\n        price: $price\n        bulk_price: $bulk_price\n        quantity: $quantity\n        description: $description\n        dosage: $dosage\n        usage: $usage\n        storage: $storage\n        category_id: $category_id\n        updated_at: $updated_at\n      }\n    ) {\n      id\n      name\n      category_id\n      price\n      bulk_price\n      quantity\n      description\n      updated_at\n    }\n  }\n"]);return o=function(){return e},e}function u(){let e=(0,r._)(["\n  mutation deleteProduct($id: uuid!) {\n    delete_products_by_pk(id: $id) {\n      id\n      name\n    }\n  }\n"]);return u=function(){return e},e}let p=(0,n.J1)(l()),x=(0,n.J1)(s()),m=(0,n.J1)(i()),g=(0,n.J1)(d()),h=(0,n.J1)(c()),f=(0,n.J1)(o()),_=(0,n.J1)(u())},8467:(e,t,a)=>{"use strict";a.d(t,{AccountProvider:()=>i,F:()=>d});var r=a(5155),n=a(2115),l=a(1567);let s=(0,n.createContext)(null),i=e=>{let{children:t}=e,[a,i]=(0,n.useState)(!1),[d,c]=(0,n.useState)(""),[o,u]=(0,n.useState)("");return(0,n.useEffect)(()=>{let e=localStorage.getItem("token"),t=(0,l.o)(e||"");console.log(t),t&&(c(t?t.role:""),u(t?t.id:"")),i(!!e)},[]),(0,r.jsx)(s.Provider,{value:{isLogin:a,role:d,setRole:c,setIsLogin:i,userId:o,setUserId:u},children:t})},d=()=>{let e=(0,n.useContext)(s);if(null===e)throw Error("useAccount must be used within a AccountProvider");return e}},6680:(e,t,a)=>{"use strict";a.d(t,{o:()=>r.A});var r=a(5875)},7835:(e,t,a)=>{"use strict";a.d(t,{G:()=>p});var r=a(5155),n=a(2115),l=a(3312),s=a(3518),i=a(6967),d=a(7192),c=a(1567);function o(e){let{className:t,classNames:a,showOutsideDays:n=!0,...o}=e;return(0,r.jsx)(d.hv,{showOutsideDays:n,className:(0,c.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,c.cn)((0,l.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,c.cn)((0,l.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:e=>{let{className:t,...a}=e;return(0,r.jsx)(s.A,{className:(0,c.cn)("h-4 w-4",t),...a})},IconRight:e=>{let{className:t,...a}=e;return(0,r.jsx)(i.A,{className:(0,c.cn)("h-4 w-4",t),...a})}},...o})}o.displayName="Calendar";var u=a(9095);function p(e){let{setSelectedDate:t,loading:a=!1}=e,[s,i]=n.useState();return(0,r.jsxs)(u.AM,{children:[(0,r.jsx)(u.Wv,{asChild:!0,children:(0,r.jsx)(l.$,{disabled:a,className:"bg-slate-200 text-inputlabel rounded-md min-w-[7rem] hover:text-white",children:"Shcedule"})}),(0,r.jsx)(u.hl,{className:"w-auto p-0",children:(0,r.jsx)(o,{mode:"single",selected:s,onSelect:e=>{i(e),t(e)},initialFocus:!0})})]})}},4136:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(5155),n=a(3900),l=a(8986);let s=e=>{let{label:t,name:a,type:s,placeHolder:i,register:d,...c}=e;return(0,r.jsxs)("div",{className:"w-full h-full flex flex-col gap-2",children:[(0,r.jsx)(l.J,{htmlFor:String(a),className:"text-inputlabel",children:t}),(0,r.jsx)(n.p,{id:String(a),type:s,placeholder:i,...d?d(a,{required:"".concat(String(a)," is required")}):{},..."file"!==s?c:{}})]})}},3604:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var r=a(5155),n=a(8986),l=a(6754),s=a(2473),i=a(2115);let d=e=>{let{label:t,name:a,placeHolder:d,register:c,...o}=e,[u,p]=(0,i.useState)("");return(0,r.jsxs)("div",{className:"w-full h-full flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"w-full flex flex-row justify-between",children:[(0,r.jsx)(n.J,{htmlFor:a,className:"text-inputlabel",children:t}),(0,r.jsxs)("label",{className:"no-underline text-inputlabel text-sm cursor-pointer",children:[(0,r.jsxs)("div",{className:"text-inputlabel text-sm flex items-center gap-1",children:[(0,r.jsx)(s.A,{size:20,color:"#796f6f"})," Upload text file"]}),(0,r.jsx)("input",{type:"file",accept:".txt",className:"hidden",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){let e=new FileReader;e.onload=()=>{p(e.result)},e.readAsText(a)}}})]})]}),(0,r.jsx)(l.T,{...c?c(a,{required:"".concat(String(a)," is required")}):{},id:a,className:"min-h-36",name:a,placeholder:d,value:u,onChange:e=>p(e.target.value),...o})]})}},6295:(e,t,a)=>{"use strict";a.d(t,{A:()=>u});var r=a(5155),n=a(2115),l=a(767),s=a(1719),i=a(8867),d=a(5699),c=a(9095),o=a(3463);let u=e=>{let{options:t,setTag:a,removeTag:u,selectedTag:p}=e,[x,m]=n.useState(!1),[g,h]=n.useState(""),[f,_]=n.useState([]),[j,b]=n.useState(""),v=n.useRef(null),y=e=>{if(p&&!p.some(t=>t.id===e.id)){let t=[...p,e];_(t),a(t)}b(""),m(!1)},w=e=>{_(t=>t.filter(t=>t.id!==e))};return(0,r.jsxs)(c.AM,{open:x,onOpenChange:m,children:[(0,r.jsx)(c.Wv,{className:"w-full",asChild:!0,children:(0,r.jsxs)("div",{ref:v,className:"flex items-center flex-wrap gap-2 border rounded px-2 py-1 focus-within:ring-2 focus-within:ring-blue-500",onClick:()=>m(!0),children:[p&&p.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-1 bg-gray-200 px-2 py-1 rounded text-sm",children:[(0,r.jsx)("span",{children:e.name}),(0,r.jsx)("button",{onClick:a=>{a.stopPropagation(),w(e.id),u(t)},className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})]},e.id)),(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)("input",{placeholder:"".concat(f.length<1?"Select Product Tag (s)":""),id:j,onChange:e=>b(e.target.id),className:"w-full text-sm text-inputname pr-6 border-none outline-none bg-transparent p-1"}),(0,r.jsx)(s.A,{size:15,color:"#796f6f",className:"absolute right-2 top-2"})]})]})}),(0,r.jsx)(c.hl,{style:{width:v.current?"".concat(v.current.offsetWidth,"px"):"auto"},className:"p-0",children:(0,r.jsxs)(d.uB,{children:[(0,r.jsx)(d.G7,{placeholder:"Search option..."}),(0,r.jsxs)(d.oI,{children:[(0,r.jsx)(d.xL,{children:"No option found."}),(0,r.jsx)(d.L$,{children:t.map(e=>(0,r.jsxs)(d.h_,{id:e.id,onSelect:t=>{h(t===g?"":t),m(!1),y(e)},children:[(0,r.jsx)(i.A,{className:(0,o.A)("mr-2 h-4 w-4",g===e.id?"opacity-100":"opacity-0")}),e.name]},e.id))})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[586,913,147,244,785,499,273,352,874,558,309,441,517,358],()=>t(5508)),_N_E=e.O()}]);