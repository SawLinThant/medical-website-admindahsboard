(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[779],{8231:(e,t,a)=>{Promise.resolve().then(a.bind(a,5624))},4807:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(7401).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},5624:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>I});var r=a(5155),n=a(3312),l=a(8986),i=a(2133),s=a(5564),d=a(9959),c=a(6572),o=a(890),u=a(4039);let g=()=>{let[e,{loading:t,error:a}]=(0,u.n)(d.kZ);return{deleteImageById:async t=>{try{var a;let r=await e({variables:{id:t}});return null==r?void 0:null===(a=r.data)||void 0===a?void 0:a.delete_images_by_pk}catch(e){throw console.error("Error deleting image:",e),e}},loadingDeleteImage:t,errorDeleteImage:a}},p=()=>{let[e,{loading:t,error:a}]=(0,u.n)(d.oY);return{deleteProductById:async t=>{try{var a;let r=await e({variables:{id:t}});return null==r?void 0:null===(a=r.data)||void 0===a?void 0:a.delete_products_by_pk}catch(e){throw console.error("Error deleting product:",e),e}},loadingDeleteProduct:t,errorDeleteProduct:a}},m=()=>{let[e,{loading:t,error:a}]=(0,u.n)(d.lm);return{deleteProductTag:async(t,a)=>{try{await e({variables:{product_id:t,tag_id:a}})}catch(e){console.log(e)}},loading:t,error:a}},x=()=>{let[e,{loading:t,error:a}]=(0,u.n)(d.q);return{updateProduct:async t=>{try{var a;let r=await e({variables:t});return null==r?void 0:null===(a=r.data)||void 0===a?void 0:a.update_products_by_pk}catch(e){throw console.error("Error updating product:",e),e}},loadingUpdateProduct:t,errorUpdateProduct:a}};var h=a(9057),f=a(3900),_=a(4807);let j=e=>{var t;let{label:a,name:n,placeHolder:i,value:s,onChange:d,register:c,...o}=e;return(0,r.jsxs)("div",{className:"w-full h-full flex flex-col gap-2",children:[(0,r.jsx)(l.J,{htmlFor:n,className:"text-inputlabel",children:a}),(0,r.jsxs)("div",{className:"w-full relative",children:[(0,r.jsx)(f.p,{id:n,name:n,type:"number",placeholder:i,value:s,onChange:d,...o,className:"py-2 pl-12 pr-2 rounded-lg border border-gray-300 ".concat(null!==(t=o.className)&&void 0!==t?t:"")}),(0,r.jsx)("div",{className:"absolute top-2 left-3.5",children:(0,r.jsx)("div",{className:"w-[25px] h-[25px] rounded-lg text-center bg-[#c5bfc7] flex items-center justify-center",children:(0,r.jsx)(_.A,{size:15,color:"#211d22"})})})]})]})};var v=a(6680),y=a(6486),b=a(4761),w=a(1621),N=a(1496),$=a(6295),k=a(7594),S=a(767),A=a(5565),P=a(6046),C=a(2115);let q=e=>{var t;let{id:a}=e,[f,_]=(0,C.useState)([]),[q,I]=(0,C.useState)(""),[T,D]=(0,C.useState)(!1),{uploadToS3:E}=(0,c.w)(),{tags:J}=(0,o.jt)(),{categories:H}=(0,o.E5)(),{toast:L}=(0,s.dj)(),{updateProduct:U}=x(),[R]=(0,u.n)(d.gI),{deleteProductTag:O}=m(),[z]=(0,u.n)(d.b),{deleteProductById:B,loadingDeleteProduct:W}=p(),F=(0,P.useRouter)(),{product:G,refetchProduct:M}=(0,o.LG)(a),[Y,Z]=(0,C.useState)({id:"",name:"",price:0,bulk_price:0,quantity:0,description:"",dosage:"",usage:"",storage:"",category_id:"",category:{id:"",name:""}}),{images:Q,refetchImage:V}=(0,o.Jd)(a),{deleteImageById:K,loadingDeleteImage:X}=g(),{tagsById:ee,loadingTags:et}=(0,o._V)(a),[ea,er]=(0,C.useState)([]);(0,C.useEffect)(()=>{ee&&er(ee)},[et]),(0,C.useEffect)(()=>{G&&Z(G)},[G]);let en=async()=>{await B(Y.id)&&F.push("/product-management/product/product-list")},el=e=>{_(t=>t.filter((t,a)=>a!==e))},ei=async e=>{await K(e)&&V()},es=async e=>{let t=[];for(let a of f){let r=await E(a);r&&(t.push(r),await z({variables:{product_id:e,image_url:r}}))}},ed=()=>{_([]),f.forEach(e=>URL.revokeObjectURL(URL.createObjectURL(e)))},ec=async e=>{if(!ee||!ea)return;let t=ea.filter(e=>!ee.some(t=>t.id===e.id)),r=ee.filter(e=>!ea.some(t=>t.id===e.id));for(let a of t)await R({variables:{product_id:e,tag_id:a.id}});for(let e of r)await O(a,e.id)},eo=async()=>{try{D(!0),await U({id:a,name:Y.name,price:Y.price,bulk_price:Y.bulk_price,quantity:1,description:Y.description,dosage:Y.dosage,usage:Y.usage,storage:Y.storage,updated_at:new Date(Date.now()).toISOString(),category_id:""===q?Y.category_id:q})&&(ec(a),await Promise.all([es(a)]),ed(),M(),V(),L({description:"Product updated"}))}catch(e){console.log("Error creating product:",e),L({variant:"destructive",title:"Uh oh! Something went wrong.",description:"There was a problem while creating product.",action:(0,r.jsx)(i.Qg,{altText:"Try again",children:"Try again"})})}finally{D(!1)}};return(0,r.jsxs)("section",{className:"w-full flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"w-full min-h-20 flex flex-row items-center gap-2",children:[(0,r.jsx)("div",{className:"h-11 w-11",children:(0,r.jsx)(v.o,{})}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Back to product list"}),(0,r.jsx)("h1",{className:"text-headercolor font-bold text-xl",children:"Product Detail"})]})]}),(0,r.jsx)("form",{children:(0,r.jsxs)("div",{className:"w-full grid lg:grid-cols-2 lg:gap-x-12 md:grid-cols-1 md:gap-y-8 min-h-32",children:[(0,r.jsxs)("div",{className:"w-[30rem] h-full flex flex-col gap-8",children:[(0,r.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,r.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Description"}),(0,r.jsxs)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex flex-col gap-6 p-8",children:[(0,r.jsx)("div",{className:"w-1/2",children:(0,r.jsx)(y.A,{name:"name",label:"Product Name",placeHolder:Y.name,type:"text",value:Y.name,onChange:e=>Z(t=>({...t,[e.target.name]:e.target.value}))})}),(0,r.jsx)(b.A,{placeHolder:"Enter Porduct Description Here",label:"Product Description",name:"description",value:Y.description||"",onChange:e=>Z(t=>({...t,[e.target.name]:e.target.value}))}),(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(y.A,{name:"dosage",label:"Dosage",placeHolder:Y.dosage||"",type:"text",value:Y.dosage||"",onChange:e=>Z(t=>({...t,[e.target.name]:e.target.value}))})}),(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(y.A,{name:"usage",label:"Usage",placeHolder:Y.usage||"",type:"text",value:Y.usage||"",onChange:e=>Z(t=>({...t,[e.target.name]:e.target.value}))})}),(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(y.A,{name:"storage",label:"Storage",placeHolder:Y.storage||"",type:"text",value:Y.storage||"",onChange:e=>Z(t=>({...t,[e.target.name]:e.target.value}))})})]})]}),(0,r.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,r.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Category & Tag"}),(0,r.jsxs)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex flex-col gap-6 p-8",children:[(0,r.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,r.jsx)(l.J,{className:"text-inputlabel",children:"Product Category"}),(0,r.jsx)(w.A,{label:null===(t=Y.category)||void 0===t?void 0:t.name,setCategory:I,options:H})]}),(0,r.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,r.jsx)(l.J,{className:"text-inputlabel",children:"Tags"}),(0,r.jsx)($.A,{removeTag:e=>{er(t=>t.filter((t,a)=>a!==e))},setTag:e=>{er(e)},options:J,selectedTag:ea})]})]})]})]}),(0,r.jsxs)("div",{className:"w-[30rem] h-full flex flex-col gap-8",children:[(0,r.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,r.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Product Images"}),(0,r.jsxs)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex flex-wrap items-center justify-center gap-6 p-8",children:[(0,r.jsx)(N.A,{className:"w-[10rem]",onFileSelect:e=>{_(t=>[...t,...Array.from(e)])},multiple:!0}),Q.map((e,t)=>(0,r.jsxs)("div",{className:"w-[10rem] h-[10rem] relative group",children:[(0,r.jsx)(A.default,{src:e.image_url,width:300,height:300,className:"w-full h-full object-cover rounded-md border",alt:"Uploaded image ".concat(t+1)}),(0,r.jsx)("div",{onClick:()=>ei(e.id),className:"absolute inset-0 flex items-center justify-center hover:cursor-pointer",children:(0,r.jsx)("div",{className:"group-hover:opacity-100 flex opacity-0 transition-all flex-row items-center px-3 py-1 rounded bg-slate-100",children:X?(0,r.jsx)(k.A,{className:"animate-spin"}):"Remove"})})]},t)),f.map((e,t)=>(0,r.jsxs)("div",{className:"w-[10rem] h-[10rem] relative",children:[(0,r.jsx)(A.default,{src:URL.createObjectURL(e),width:100,height:100,className:"w-full h-full object-cover rounded-md border",alt:"Uploaded image ".concat(t+1)}),(0,r.jsx)("div",{onClick:()=>el(t),className:"absolute top-1 right-2 hover:cursor-pointer",children:(0,r.jsx)(S.A,{size:30,color:"black"})})]},t))]})]}),(0,r.jsxs)("div",{className:"w-full min-h-20 flex flex-col gap-2",children:[(0,r.jsx)("h2",{className:"font-bold text-lg text-headercolor",children:"Pricing"}),(0,r.jsx)("div",{className:"w-full min-h-20 border border-gray-300 rounded-md flex items-center justify-center gap-6 p-8",children:(0,r.jsxs)("div",{className:"w-full grid grid-cols-2 gap-4",children:[(0,r.jsx)(j,{label:"Price",name:"price",placeHolder:"000.00",value:Y.price,onChange:e=>Z(t=>({...t,[e.target.name]:e.target.value}))}),(0,r.jsx)(j,{label:"Bulk Price",name:"bulk_price",placeHolder:"000.00",value:Y.bulk_price,onChange:e=>Z(t=>({...t,[e.target.name]:e.target.value}))})]})})]}),(0,r.jsxs)("div",{className:"w-full min-h-20 flex flex-row justify-between",children:[(0,r.jsx)("div",{}),(0,r.jsxs)("div",{className:"flex flex-row gap-3",children:[(0,r.jsx)("div",{className:"min-w-[7rem]",children:(0,r.jsx)(h.W,{label:"Delete",heading:"Are you sure you want to delete this product?",caption:"This action will permanently delete this product from the shop",actionDescription:"Deleting the product",action:en,actionLoading:W})}),(0,r.jsx)(n.$,{type:"button",onClick:eo,disabled:T,className:"rounded-md flex items-center justify-center text-white bg-inputlabel min-w-[7rem]",children:T?(0,r.jsx)(k.A,{className:"animate-spin",size:25}):"Save"})]})]})]})]})})]})},I=()=>{let{productId:e}=(0,P.useParams)();return(0,r.jsx)("div",{className:"",children:(0,r.jsx)(q,{id:e||""})})}},9959:(e,t,a)=>{"use strict";a.d(t,{b:()=>x,gI:()=>p,kZ:()=>h,lm:()=>m,oY:()=>_,q:()=>f,xq:()=>g});var r=a(698),n=a(8247);function l(){let e=(0,r._)(["\n  mutation createProduct(\n    $name: String\n    $price: Int\n    $bulk_price: Int\n    $quantity: Int\n    $description: String\n    $dosage: String\n    $usage: String\n    $storage: String\n    $shop_id: uuid\n    $category_id: uuid\n    $created_at: timestamptz\n  ) {\n    insert_products_one(\n      object: {\n        name: $name\n        price: $price\n        bulk_price: $bulk_price\n        quantity: $quantity\n        description: $description\n        dosage: $dosage\n        usage: $usage\n        storage: $storage\n        shop_id: $shop_id\n        category_id: $category_id\n        created_at: $created_at\n      }\n    ) {\n      id\n      name\n      category_id\n      price\n      bulk_price\n      quantity\n      description\n      created_at\n    }\n  }\n"]);return l=function(){return e},e}function i(){let e=(0,r._)(["\n  mutation createProductTag($product_id: uuid, $tag_id: uuid) {\n    insert_product_tags_one(\n      object: { product_id: $product_id, tag_id: $tag_id }\n    ) {\n      id\n      product_id\n      tag_id\n    }\n  }\n"]);return i=function(){return e},e}function s(){let e=(0,r._)(["\n  mutation DeleteProductTag($product_id: uuid!, $tag_id: uuid!) {\n    delete_product_tags(\n      where: { product_id: { _eq: $product_id }, tag_id: { _eq: $tag_id } }\n    ) {\n      affected_rows\n    }\n  }\n"]);return s=function(){return e},e}function d(){let e=(0,r._)(["\n  mutation createImage($product_id: uuid, $image_url: String) {\n    insert_images_one(\n      object: { product_id: $product_id, image_url: $image_url }\n    ) {\n      id\n      product_id\n      image_url\n    }\n  }\n"]);return d=function(){return e},e}function c(){let e=(0,r._)(["\n  mutation deleteImage($id: uuid!) {\n    delete_images_by_pk(id: $id) {\n      id\n      product_id\n      image_url\n    }\n  }\n"]);return c=function(){return e},e}function o(){let e=(0,r._)(["\n  mutation updateProduct(\n    $id: uuid!\n    $name: String\n    $price: Int\n    $bulk_price: Int\n    $quantity: Int\n    $description: String\n    $dosage: String\n    $usage: String\n    $storage: String\n    $category_id: uuid\n    $updated_at: timestamptz\n  ) {\n    update_products_by_pk(\n      pk_columns: { id: $id }\n      _set: {\n        name: $name\n        price: $price\n        bulk_price: $bulk_price\n        quantity: $quantity\n        description: $description\n        dosage: $dosage\n        usage: $usage\n        storage: $storage\n        category_id: $category_id\n        updated_at: $updated_at\n      }\n    ) {\n      id\n      name\n      category_id\n      price\n      bulk_price\n      quantity\n      description\n      updated_at\n    }\n  }\n"]);return o=function(){return e},e}function u(){let e=(0,r._)(["\n  mutation deleteProduct($id: uuid!) {\n    delete_products_by_pk(id: $id) {\n      id\n      name\n    }\n  }\n"]);return u=function(){return e},e}let g=(0,n.J1)(l()),p=(0,n.J1)(i()),m=(0,n.J1)(s()),x=(0,n.J1)(d()),h=(0,n.J1)(c()),f=(0,n.J1)(o()),_=(0,n.J1)(u())},6680:(e,t,a)=>{"use strict";a.d(t,{o:()=>r.A});var r=a(5875)},6295:(e,t,a)=>{"use strict";a.d(t,{A:()=>u});var r=a(5155),n=a(2115),l=a(767),i=a(1719),s=a(8867),d=a(5699),c=a(9095),o=a(3463);let u=e=>{let{options:t,setTag:a,removeTag:u,selectedTag:g}=e,[p,m]=n.useState(!1),[x,h]=n.useState(""),[f,_]=n.useState([]),[j,v]=n.useState(""),y=n.useRef(null),b=e=>{if(g&&!g.some(t=>t.id===e.id)){let t=[...g,e];_(t),a(t)}v(""),m(!1)},w=e=>{_(t=>t.filter(t=>t.id!==e))};return(0,r.jsxs)(c.AM,{open:p,onOpenChange:m,children:[(0,r.jsx)(c.Wv,{className:"w-full",asChild:!0,children:(0,r.jsxs)("div",{ref:y,className:"flex items-center flex-wrap gap-2 border rounded px-2 py-1 focus-within:ring-2 focus-within:ring-blue-500",onClick:()=>m(!0),children:[g&&g.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-1 bg-gray-200 px-2 py-1 rounded text-sm",children:[(0,r.jsx)("span",{children:e.name}),(0,r.jsx)("button",{onClick:a=>{a.stopPropagation(),w(e.id),u(t)},className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})]},e.id)),(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)("input",{placeholder:"".concat(f.length<1?"Select Product Tag (s)":""),id:j,onChange:e=>v(e.target.id),className:"w-full text-sm text-inputname pr-6 border-none outline-none bg-transparent p-1"}),(0,r.jsx)(i.A,{size:15,color:"#796f6f",className:"absolute right-2 top-2"})]})]})}),(0,r.jsx)(c.hl,{style:{width:y.current?"".concat(y.current.offsetWidth,"px"):"auto"},className:"p-0",children:(0,r.jsxs)(d.uB,{children:[(0,r.jsx)(d.G7,{placeholder:"Search option..."}),(0,r.jsxs)(d.oI,{children:[(0,r.jsx)(d.xL,{children:"No option found."}),(0,r.jsx)(d.L$,{children:t.map(e=>(0,r.jsxs)(d.h_,{id:e.id,onSelect:t=>{h(t===x?"":t),m(!1),b(e)},children:[(0,r.jsx)(s.A,{className:(0,o.A)("mr-2 h-4 w-4",x===e.id?"opacity-100":"opacity-0")}),e.name]},e.id))})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[586,913,147,244,785,499,273,558,309,7,441,517,358],()=>t(8231)),_N_E=e.O()}]);